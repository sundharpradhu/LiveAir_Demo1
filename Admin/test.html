<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LiveAir - User Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .nav-link {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      color: #374151;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.2s;
      gap: 12px;
    }
    
    .nav-link:hover {
      background-color: #f3f4f6;
      color: #1f2937;
    }
    
    .nav-active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white !important;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      max-width: 90vw;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.95);
      transition: transform 0.3s ease;
    }
    
    .modal-overlay.active .modal-container {
      transform: scale(1);
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.2s;
      cursor: pointer;
      border: none;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #5a67d8 0%, #6b5b95 100%);
    }
    
    .btn-secondary {
      background: #f3f4f6;
      color: #374151;
    }
    
    .btn-secondary:hover {
      background: #e5e7eb;
    }
    
    .btn-danger {
      background: #ef4444;
      color: white;
    }
    
    .btn-danger:hover {
      background: #dc2626;
    }
    
    .role-badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .role-super-admin {
      background: #fee2e2;
      color: #dc2626;
    }
    
    .role-admin {
      background: #fef3c7;
      color: #d97706;
    }
    
    .role-manager {
      background: #dbeafe;
      color: #2563eb;
    }
    
    .role-delivery {
      background: #dcfce7;
      color: #16a34a;
    }
    
    .role-technician {
      background: #e0e7ff;
      color: #6366f1;
    }
    
    .role-client-admin {
      background: #fce7f3;
      color: #be185d;
    }
    
    .role-client-manager {
      background: #f0fdf4;
      color: #15803d;
    }
    
    .status-active {
      background: #dcfce7;
      color: #16a34a;
    }
    
    .status-inactive {
      background: #fecaca;
      color: #dc2626;
    }
    
    .status-pending {
      background: #fef3c7;
      color: #d97706;
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 20px;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 10000;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    .notification.success {
      background: #10b981;
    }
    
    .notification.error {
      background: #ef4444;
    }
    
    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="bg-gray-50 flex h-screen">
  
  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-lg flex flex-col">
    <div class="p-4 gradient-bg text-white font-bold text-xl text-center">
      <i data-lucide="wind" class="w-6 h-6 inline mr-2"></i>
      LiveAir
    </div>
    
    <nav class="flex-1 p-4 space-y-2">
      <a href="#dashboard" class="nav-link" data-page="dashboard">
        <i data-lucide="home" class="w-5 h-5"></i>
        <span>Dashboard</span>
      </a>
      <a href="assets.html" class="nav-link"><i data-lucide="package" class="w-5 h-5"></i><span>My Products</span></a>
      <a href="tracking.html" class="nav-link"><i data-lucide="search" class="w-5 h-5"></i><span>Tracking</span></a>
      
      
      <a href="#users" class="nav-link nav-active" data-page="users">
        <i data-lucide="users" class="w-5 h-5"></i>
        <span>User Management</span>
      </a>
      
      <a href="#roles" class="nav-link" data-page="roles">
        <i data-lucide="shield" class="w-5 h-5"></i>
        <span>Roles & Permissions</span>
      </a>
      
      <a href="#audit" class="nav-link" data-page="audit">
        <i data-lucide="activity" class="w-5 h-5"></i>
        <span>Audit Logs</span>
      </a>
    </nav>
    
    <div class="p-4 border-t text-sm text-gray-500 text-center">
      Â© 2025 LiveAir Systems
    </div>
  </aside>
  
  <!-- Main Content -->
  <main class="flex-1 flex flex-col overflow-hidden">
    
    <!-- Header -->
    <header class="bg-white shadow-sm border-b p-4 flex justify-between items-center">
      <div>
        <h1 id="pageTitle" class="font-bold text-xl text-gray-900">User Management</h1>
        <p class="text-sm text-gray-600">Manage users, roles and permissions</p>
      </div>
      
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center text-white font-semibold">
            S
          </div>
          <span class="text-sm font-medium text-gray-700">Super Admin</span>
        </div>
      </div>
    </header>
    
    <!-- Page Content -->
    <div class="flex-1 overflow-hidden">
      
      <!-- User Management Page -->
      <div id="users" class="page-content p-6 h-full overflow-y-auto">
        <div class="max-w-7xl mx-auto">
          
          <!-- User Stats -->
          <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center">
                <div class="p-2 bg-blue-100 rounded-lg mr-3">
                  <i data-lucide="users" class="w-6 h-6 text-blue-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Total Users</p>
                  <p class="text-2xl font-bold text-gray-900" id="totalUsers">47</p>
                </div>
              </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center">
                <div class="p-2 bg-green-100 rounded-lg mr-3">
                  <i data-lucide="check-circle" class="w-6 h-6 text-green-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Active Users</p>
                  <p class="text-2xl font-bold text-gray-900">42</p>
                </div>
              </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center">
                <div class="p-2 bg-yellow-100 rounded-lg mr-3">
                  <i data-lucide="clock" class="w-6 h-6 text-yellow-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Pending Approval</p>
                  <p class="text-2xl font-bold text-gray-900">3</p>
                </div>
              </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center">
                <div class="p-2 bg-red-100 rounded-lg mr-3">
                  <i data-lucide="user-x" class="w-6 h-6 text-red-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Inactive Users</p>
                  <p class="text-2xl font-bold text-gray-900">5</p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- User Actions -->
          <div class="flex justify-between items-center mb-6">
            <div class="flex items-center gap-3">
              <div class="relative">
                <i data-lucide="search" class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                <input type="text" placeholder="Search users..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" id="userSearch">
              </div>
              <select class="px-3 py-2 border border-gray-300 rounded-lg" id="roleFilter">
                <option value="">All Roles</option>
                <option value="super_admin">Super Admin</option>
                <option value="admin">Admin</option>
                <option value="manager">Manager</option>
                <option value="delivery_boy">Delivery Boy</option>
                <option value="technician">Technician</option>
                <option value="client_admin">Client Admin</option>
                <option value="client_manager">Client Manager</option>
              </select>
            </div>
            
            <div class="flex gap-3">
              <button class="btn btn-secondary" onclick="exportUsers()">
                <i data-lucide="download" class="w-4 h-4"></i>
                Export Users
              </button>
              <button class="btn btn-primary" onclick="openUserModal()">
                <i data-lucide="user-plus" class="w-4 h-4"></i>
                Add User
              </button>
            </div>
          </div>
          
          <!-- Users Table -->
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
              <table class="w-full" id="usersTable">
                <thead class="bg-gray-50 border-b border-gray-200">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Department</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Login</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200" id="usersTableBody">
                  <!-- Users will be populated here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Roles & Permissions Page -->
      <div id="roles" class="page-content hidden p-6 h-full overflow-y-auto">
        <div class="max-w-7xl mx-auto">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-900">Roles & Permissions</h2>
            <button class="btn btn-primary" onclick="openRoleModal()">
              <i data-lucide="plus" class="w-4 h-4"></i>
              Create Role
            </button>
          </div>
          
          <!-- Roles Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="rolesGrid">
            <!-- Roles will be populated here -->
          </div>
        </div>
      </div>
      
      <!-- Audit Logs Page -->
      <div id="audit" class="page-content hidden p-6 h-full overflow-y-auto">
        <div class="max-w-7xl mx-auto">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Audit Logs</h2>
          
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-200">
              <div class="flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-900">System Activity</h3>
                <div class="flex items-center gap-3">
                  <input type="date" class="px-3 py-2 border border-gray-300 rounded-lg">
                  <select class="px-3 py-2 border border-gray-300 rounded-lg">
                    <option>All Actions</option>
                    <option>Login</option>
                    <option>User Created</option>
                    <option>Role Changed</option>
                    <option>Permission Modified</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Timestamp</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">User</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Action</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Details</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">IP Address</th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200" id="auditLogsBody">
                  <!-- Audit logs will be populated here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </main>
  
  <!-- User Modal -->
  <div id="userModal" class="modal-overlay">
    <div class="modal-container w-full max-w-2xl">
      <div class="p-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-medium text-gray-900" id="userModalTitle">Add New User</h3>
          <button onclick="closeUserModal()" class="text-gray-400 hover:text-gray-600">
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>
      </div>
      
      <form id="userForm" class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
            <input type="text" name="firstName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
            <input type="text" name="lastName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
            <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
            <input type="tel" name="phone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
            <select name="role" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updatePermissions()">
              <option value="">Select Role</option>
              <option value="admin">Admin</option>
              <option value="manager">Manager</option>
              <option value="delivery_boy">Delivery Boy</option>
              <option value="technician">Technician</option>
              <option value="client_admin">Client Admin</option>
              <option value="client_manager">Client Manager</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
            <select name="department" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
              <option value="">Select Department</option>
              <option value="operations">Operations</option>
              <option value="delivery">Delivery</option>
              <option value="technical">Technical Support</option>
              <option value="sales">Sales</option>
              <option value="finance">Finance</option>
              <option value="client_services">Client Services</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Employee ID</label>
            <input type="text" name="employeeId" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Reporting Manager</label>
            <select name="manager" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
              <option value="">Select Manager</option>
              <option value="john_doe">John Doe (Manager)</option>
              <option value="jane_smith">Jane Smith (Senior Manager)</option>
            </select>
          </div>
          
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">Permissions</label>
            <div class="border border-gray-300 rounded-lg p-4 max-h-48 overflow-y-auto" id="permissionsContainer">
              <!-- Permissions will be populated based on role -->
            </div>
          </div>
          
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
            <textarea name="notes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Additional notes about the user..."></textarea>
          </div>
        </div>
        
        <div class="flex justify-end gap-3 pt-6 mt-6 border-t border-gray-200">
          <button type="button" onclick="closeUserModal()" class="btn btn-secondary">Cancel</button>
          <button type="submit" class="btn btn-primary">
            <i data-lucide="plus" class="w-4 h-4"></i>
            <span id="userSubmitText">Add User</span>
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Role Modal -->
  <div id="roleModal" class="modal-overlay">
    <div class="modal-container w-full max-w-lg">
      <div class="p-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-medium text-gray-900">Create New Role</h3>
          <button onclick="closeRoleModal()" class="text-gray-400 hover:text-gray-600">
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>
      </div>
      
      <form id="roleForm" class="p-6">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Role Name</label>
            <input type="text" name="roleName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
            <textarea name="description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Access Level</label>
            <select name="accessLevel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
              <option value="basic">Basic</option>
              <option value="intermediate">Intermediate</option>
              <option value="advanced">Advanced</option>
              <option value="full">Full Access</option>
            </select>
          </div>
        </div>
        
        <div class="flex justify-end gap-3 pt-6 mt-6 border-t border-gray-200">
          <button type="button" onclick="closeRoleModal()" class="btn btn-secondary">Cancel</button>
          <button type="submit" class="btn btn-primary">
            <i data-lucide="plus" class="w-4 h-4"></i>
            Create Role
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Sample user data
    const users = [
      {
        id: 1,
        firstName: "John",
        lastName: "Doe",
        email: "john.doe@liveair.com",
        phone: "+91 9876543210",
        role: "admin",
        department: "operations",
        status: "active",
        lastLogin: "2025-01-08 14:30",
        employeeId: "LA001",
        avatar: "JD"
      },
      {
        id: 2,
        firstName: "Jane",
        lastName: "Smith",
        email: "jane.smith@liveair.com",
        phone: "+91 9876543211",
        role: "manager",
        department: "operations",
        status: "active",
        lastLogin: "2025-01-08 09:15",
        employeeId: "LA002",
        avatar: "JS"
      },
      {
        id: 3,
        firstName: "Ravi",
        lastName: "Kumar",
        email: "ravi.kumar@liveair.com",
        phone: "+91 9876543212",
        role: "delivery_boy",
        department: "delivery",
        status: "active",
        lastLogin: "2025-01-08 08:00",
        employeeId: "LA003",
        avatar: "RK"
      },
      {
        id: 4,
        firstName: "Priya",
        lastName: "Sharma",
        email: "priya.sharma@liveair.com",
        phone: "+91 9876543213",
        role: "technician",
        department: "technical",
        status: "active",
        lastLogin: "2025-01-07 16:45",
        employeeId: "LA004",
        avatar: "PS"
      },
      {
        id: 5,
        firstName: "Amit",
        lastName: "Patel",
        email: "amit.patel@clientcorp.com",
        phone: "+91 9876543214",
        role: "client_admin",
        department: "client_services",
        status: "pending",
        lastLogin: "Never",
        employeeId: "CC001",
        avatar: "AP"
      }
    ];
    
    // Role definitions with permissions
    const roles = {
      super_admin: {
        name: "Super Admin",
        color: "role-super-admin",
        permissions: ["all_access", "user_management", "system_config", "audit_logs", "role_management"]
      },
      admin: {
        name: "Admin",
        color: "role-admin",
        permissions: ["user_management", "order_management", "client_management", "reports", "settings"]
      },
      manager: {
        name: "Manager",
        color: "role-manager",
        permissions: ["order_management", "client_management", "team_management", "reports"]
      },
      delivery_boy: {
        name: "Delivery Boy",
        color: "role-delivery",
        permissions: ["delivery_management", "order_view", "route_planning"]
      },
      technician: {
        name: "Technician",
        color: "role-technician",
        permissions: ["service_management", "asset_maintenance", "repair_logs"]
      },
      client_admin: {
        name: "Client Admin",
        color: "role-client-admin",
        permissions: ["client_orders", "client_reports", "client_team_management"]
      },
      client_manager: {
        name: "Client Manager",
        color: "role-client-manager",
        permissions: ["client_orders", "client_reports"]
      }
    };
    
    // Permission definitions
    const permissions = {
      all_access: "Full System Access",
      user_management: "User Management",
      system_config: "System Configuration",
      audit_logs: "Audit Logs",
      role_management: "Role Management",
      order_management: "Order Management",
      client_management: "Client Management",
      team_management: "Team Management",
      reports: "Reports & Analytics",
      settings: "System Settings",
      delivery_management: "Delivery Management",
      order_view: "View Orders",
      route_planning: "Route Planning",
      service_management: "Service Management",
      asset_maintenance: "Asset Maintenance",
      repair_logs: "Repair Logs",
      client_orders: "Client Orders",
      client_reports: "Client Reports",
      client_team_management: "Client Team Management"
    };
    
    // Global variables
    const navLinks = document.querySelectorAll('.nav-link[data-page]');
    const pageContents = document.querySelectorAll('.page-content');
    const pageTitle = document.getElementById('pageTitle');
    
    // Initialize page navigation
    navLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetPage = link.dataset.page;
        
        // Update active nav
        navLinks.forEach(l => l.classList.remove('nav-active'));
        link.classList.add('nav-active');
        
        // Show target page
        pageContents.forEach(page => {
          if (page.id === targetPage) {
            page.classList.remove('hidden');
          } else {
            page.classList.add('hidden');
          }
        });
        
        // Update page title
        const pageTitles = {
          users: 'User Management',
          roles: 'Roles & Permissions',
          audit: 'Audit Logs'
        };
        pageTitle.textContent = pageTitles[targetPage] || 'User Management';
      });
    });
    
    // Populate users table
    function populateUsersTable() {
      const tbody = document.getElementById('usersTableBody');
      tbody.innerHTML = '';
      
      users.forEach(user => {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-medium mr-3">
                ${user.avatar}
              </div>
              <div>
                <div class="text-sm font-medium text-gray-900">${user.firstName} ${user.lastName}</div>
                <div class="text-sm text-gray-500">${user.email}</div>
              </div>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="role-badge ${roles[user.role].color}">${roles[user.role].name}</span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${user.department}</td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="role-badge status-${user.status}">${user.status.charAt(0).toUpperCase() + user.status.slice(1)}</span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.lastLogin}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
            <button class="text-blue-600 hover:text-blue-900 mr-3" onclick="editUser(${user.id})">Edit</button>
            <button class="text-red-600 hover:text-red-900" onclick="deleteUser(${user.id})">Delete</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Populate roles grid
    function populateRolesGrid() {
      const grid = document.getElementById('rolesGrid');
      grid.innerHTML = '';
      
      Object.entries(roles).forEach(([roleKey, role]) => {
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow';
        card.innerHTML = `
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-900">${role.name}</h3>
            <span class="role-badge ${role.color}">${role.permissions.length}</span>
          </div>
          <div class="space-y-2 mb-4">
            ${role.permissions.slice(0, 3).map(perm => 
              `<div class="text-sm text-gray-600">â¢ ${permissions[perm]}</div>`
            ).join('')}
            ${role.permissions.length > 3 ? 
              `<div class="text-sm text-gray-500">+ ${role.permissions.length - 3} more permissions</div>` : ''}
          </div>
          <div class="flex justify-end space-x-2">
            <button class="text-blue-600 hover:text-blue-900 text-sm font-medium">Edit</button>
            <button class="text-red-600 hover:text-red-900 text-sm font-medium">Delete</button>
          </div>
        `;
        grid.appendChild(card);
      });
    }
    
    // Populate audit logs
    function populateAuditLogs() {
      const tbody = document.getElementById('auditLogsBody');
      const auditLogs = [
        {
          timestamp: '2025-01-08 14:30:25',
          user: 'John Doe',
          action: 'User Login',
          details: 'Successful login from desktop',
          ip: '192.168.1.100'
        },
        {
          timestamp: '2025-01-08 14:15:10',
          user: 'System',
          action: 'User Created',
          details: 'New user Amit Patel created',
          ip: '10.0.0.1'
        },
        {
          timestamp: '2025-01-08 13:45:30',
          user: 'Jane Smith',
          action: 'Role Changed',
          details: 'Updated Ravi Kumar role to Delivery Boy',
          ip: '192.168.1.105'
        },
        {
          timestamp: '2025-01-08 12:20:15',
          user: 'John Doe',
          action: 'Permission Modified',
          details: 'Added order_management permission to Manager role',
          ip: '192.168.1.100'
        }
      ];
      
      tbody.innerHTML = '';
      auditLogs.forEach(log => {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${log.timestamp}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${log.user}</td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="role-badge status-active">${log.action}</span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${log.details}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${log.ip}</td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Modal functions
    function openUserModal(userId = null) {
      const modal = document.getElementById('userModal');
      const form = document.getElementById('userForm');
      const title = document.getElementById('userModalTitle');
      const submitText = document.getElementById('userSubmitText');
      
      if (userId) {
        const user = users.find(u => u.id === userId);
        if (user) {
          title.textContent = 'Edit User';
          submitText.textContent = 'Update User';
          
          // Populate form with user data
          form.firstName.value = user.firstName;
          form.lastName.value = user.lastName;
          form.email.value = user.email;
          form.phone.value = user.phone;
          form.role.value = user.role;
          form.department.value = user.department;
          form.employeeId.value = user.employeeId;
          
          updatePermissions();
        }
      } else {
        title.textContent = 'Add New User';
        submitText.textContent = 'Add User';
        form.reset();
      }
      
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeUserModal() {
      document.getElementById('userModal').classList.remove('active');
      document.body.style.overflow = 'auto';
    }
    
    function openRoleModal() {
      document.getElementById('roleModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeRoleModal() {
      document.getElementById('roleModal').classList.remove('active');
      document.body.style.overflow = 'auto';
    }
    
    // Update permissions based on selected role
    function updatePermissions() {
      const roleSelect = document.querySelector('select[name="role"]');
      const permissionsContainer = document.getElementById('permissionsContainer');
      const selectedRole = roleSelect.value;
      
      if (selectedRole && roles[selectedRole]) {
        const rolePermissions = roles[selectedRole].permissions;
        permissionsContainer.innerHTML = rolePermissions.map(perm => `
          <div class="flex items-center space-x-3 mb-2">
            <input type="checkbox" id="perm_${perm}" name="permissions[]" value="${perm}" checked class="rounded">
            <label for="perm_${perm}" class="text-sm text-gray-700">${permissions[perm]}</label>
          </div>
        `).join('');
      } else {
        permissionsContainer.innerHTML = '<p class="text-gray-500 text-sm">Select a role to view permissions</p>';
      }
    }
    
    // User management functions
    function editUser(userId) {
      openUserModal(userId);
    }
    
    function deleteUser(userId) {
      if (confirm('Are you sure you want to delete this user?')) {
        const userIndex = users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
          users.splice(userIndex, 1);
          populateUsersTable();
          showNotification('User deleted successfully', 'success');
        }
      }
    }
    
    function exportUsers() {
      showNotification('User export started', 'success');
    }
    
    // Form submission handlers
    document.getElementById('userForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      const userData = Object.fromEntries(formData.entries());
      
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<div class="loading-spinner mr-2"></div>Processing...';
      submitBtn.disabled = true;
      
      setTimeout(() => {
        // Simulate user creation/update
        if (document.getElementById('userModalTitle').textContent === 'Add New User') {
          const newUser = {
            id: users.length + 1,
            firstName: userData.firstName,
            lastName: userData.lastName,
            email: userData.email,
            phone: userData.phone,
            role: userData.role,
            department: userData.department,
            status: 'active',
            lastLogin: 'Never',
            employeeId: userData.employeeId,
            avatar: userData.firstName.charAt(0) + userData.lastName.charAt(0)
          };
          users.push(newUser);
          showNotification('User added successfully!', 'success');
        } else {
          showNotification('User updated successfully!', 'success');
        }
        
        populateUsersTable();
        closeUserModal();
        
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }, 1500);
    });
    
    document.getElementById('roleForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<div class="loading-spinner mr-2"></div>Creating...';
      submitBtn.disabled = true;
      
      setTimeout(() => {
        showNotification('Role created successfully!', 'success');
        populateRolesGrid();
        closeRoleModal();
        
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }, 1500);
    });
    
    // Search and filter functionality
    document.getElementById('userSearch').addEventListener('input', function() {
      const searchTerm = this.value.toLowerCase();
      const rows = document.querySelectorAll('#usersTableBody tr');
      
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(searchTerm) ? '' : 'none';
      });
    });
    
    document.getElementById('roleFilter').addEventListener('change', function() {
      const selectedRole = this.value;
      const rows = document.querySelectorAll('#usersTableBody tr');
      
      rows.forEach(row => {
        if (!selectedRole) {
          row.style.display = '';
        } else {
          const roleCell = row.querySelector('.role-badge');
          const userRole = Array.from(roleCell.classList).find(cls => cls.startsWith('role-'));
          row.style.display = userRole === `role-${selectedRole.replace('_', '-')}` ? '' : 'none';
        }
      });
    });
    
    // Notification system
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.add('show');
      }, 100);
      
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }
    
    // Close modals on outside click
    document.querySelectorAll('.modal-overlay').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
          document.body.style.overflow = 'auto';
        }
      });
    });
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        document.querySelectorAll('.modal-overlay.active').forEach(modal => {
          modal.classList.remove('active');
          document.body.style.overflow = 'auto';
        });
      }
    });
    
    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      populateUsersTable();
      populateRolesGrid();
      populateAuditLogs();
    });
  </script>
</body>
</html>