<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LiveAir - Delivery Assignment</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-gray-100 flex h-screen">
  
  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-lg flex flex-col">
    <div class="p-4 gradient-bg text-white font-bold text-xl">LiveAir</div>
    <nav class="flex-1 p-4 space-y-1">
      <a href="index.html" class="nav-link"><i data-lucide="home" class="w-5 h-5"></i><span>Home</span></a>
      <a href="clients.html" class="nav-link"><i data-lucide="users" class="w-5 h-5"></i><span>Clients</span></a>
      <details class="group" open>
        <summary class="nav-link"><i data-lucide="shopping-cart" class="w-5 h-5"></i><span>My Orders</span></summary>
        <div class="pl-8 py-1 space-y-1">
          <a href="orders-commercial.html" class="nav-link"><i data-lucide="store" class="w-5 h-5"></i><span>Commercial Orders</span></a>
          <a href="orders-retail.html" class="nav-link"><i data-lucide="shopping-bag" class="w-5 h-5"></i><span>Retail Orders</span></a>
        </div>
      </details>
      <a href="assets.html" class="nav-link"><i data-lucide="package" class="w-5 h-5"></i><span>My Products</span></a>
      <a href="tracking.html" class="nav-link"><i data-lucide="search" class="w-5 h-5"></i><span>Tracking</span></a>
      <a href="delivery.html" class="nav-link nav-active"><i data-lucide="truck" class="w-5 h-5"></i><span>Delivery Assignment</span></a>
      <a href="service-repair.html" class="nav-link"><i data-lucide="wrench" class="w-5 h-5"></i><span>Service & Repair</span></a>
      <a href="invoices.html" class="nav-link"><i data-lucide="file-text" class="w-5 h-5"></i><span>Invoices & Payments</span></a>
      <a href="alerts.html" class="nav-link"><i data-lucide="bell-ring" class="w-5 h-5"></i><span>Alerts</span></a>
    </nav>
    <div class="p-4 small">¬© 2025 LiveAir</div>
  </aside>
    
  <!-- Main Section -->
  <main class="flex-1 flex flex-col">
    
    <!-- Header -->
    <header class="bg-white shadow p-4 flex justify-between items-center">
      <h1 class="font-bold text-lg">Admin Dashboard</h1>
      <div class="flex items-center gap-3">
        <button title="Language" class="bg-gray-100 px-3 py-1 rounded">üåê EN</button>
        <button title="Notifications" class="bg-gray-100 p-2 rounded"><i data-lucide="bell" class="w-5 h-5"></i></button>
        <div title="Profile" class="bg-blue-600 w-8 h-8 rounded-full text-white grid place-items-center">A</div>
      </div>
    </header>
    

    <!-- Success Banner (top of screen) -->
    <div id="successBanner" 
         class="hidden fixed top-5 left-1/2 transform -translate-x-1/2 
                bg-green-100 border border-green-400 text-green-700 
                px-6 py-3 rounded-lg shadow-lg z-50">
      ‚úÖ Delivery Boy added successfully!
    </div>

    <!-- Delivery Assignment -->
    <section class="p-6 overflow-y-auto flex-1">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold">Delivery Assignment</h2>
        
        <div class="flex gap-3">
          <button id="assignSelectedBtn" class="px-4 py-2 bg-green-600 text-white rounded shadow hover:bg-blue-700">
  Assign Selected
</button>
          <button onclick="openModal()" class="px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700">
            + Add Delivery Boy
          </button>
        </div>
      </div>

      <!-- Pending message -->
      <div class="mb-3">
        <p id="pendingMsg" class="text-gray-600 italic">Loading...</p>
      </div>

      <table class="w-full bg-white rounded shadow overflow-hidden">
  <thead>
    <tr class="bg-gray-100 text-left">
            <th class="p-2"><input type="checkbox" id="selectAll"></th>
            <th class="p-2">Order ID</th>
            <th class="p-2">Client Name</th>
            <th class="p-2">Location</th>
            <th class="p-2">Delivery Date</th>
            <th class="p-2">Priority</th>
            <th class="p-2">Assigned To</th>
            <th class="p-2">Action</th>
          </tr>
  </thead>
  <tbody>
    <tr class="border-t">
      <td class="p-2"><input type="checkbox" class="row-select"></td>
      <td class="p-2">C-1001</td>
      <td class="p-2">Acme Corp</td>
      <td class="p-2">Chennai</td>
      <td class="p-2 delivery-date">-</td>
      <td class="p-2 priority-cell">-</td>
      <td class="p-2">
        <select class="border rounded px-2 py-1 assigned-to">
          <option>Ravi</option>
          <option>Ashok</option>
          <option>Gowtham</option>
          <option>Manoj</option>
          <option>Karthik</option>
        </select>
      </td>
      <td class="p-2"><button class="assign-btn px-3 py-1 bg-blue-500 text-white rounded">Assign</button></td>
    </tr>
    <tr class="border-t">
      <td class="p-2"><input type="checkbox" class="row-select"></td>
      <td class="p-2">C-1002</td>
      <td class="p-2">Priya</td>
      <td class="p-2">Coimbatore</td>
      <td class="p-2 delivery-date">-</td>
      <td class="p-2 priority-cell">-</td>
      <td class="p-2">
        <select class="border rounded px-2 py-1 assigned-to">
          <option>Ashok (DLV-13)</option>
          <option>Ravi (DLV-12)</option>
          <option>Gowtham (DLV-14)</option>
          <option>Manoj (DLV-15)</option>
          <option>Karthik (DLV-16)</option>
        </select>
      </td>
      <td class="p-2"><button class="assign-btn px-3 py-1 bg-blue-500 text-white rounded">Assign</button></td>
    </tr>
    <tr class="border-t">
      <td class="p-2"><input type="checkbox" class="row-select"></td>
      <td class="p-2">C-1003</td>
      <td class="p-2">Senthil</td>
      <td class="p-2">Madurai</td>
      <td class="p-2 delivery-date">-</td>
      <td class="p-2 priority-cell">-</td>
      <td class="p-2">
        <select class="border rounded px-2 py-1 assigned-to">
          <option>Gowtham (DLV-14)</option>
          <option>Ravi (DLV-12)</option>
          <option>Ashok (DLV-13)</option>
          <option>Manoj (DLV-15)</option>
          <option>Karthik (DLV-16)</option>
        </select>
      </td>
      <td class="p-2"><button class="assign-btn px-3 py-1 bg-blue-500 text-white rounded">Assign</button></td>
    </tr>
  </tbody>
</table>


      <!-- "No pending" card (optional) -->
      <div id="noPendingCard" class="mt-4 p-4 bg-gray-50 border rounded hidden">
        <p class="text-gray-500">No pending deliveries for today.</p>
      </div>
    </section>
  </main>

  <!-- Modal for Adding Delivery Boy -->
  <div id="deliveryBoyModal" class="hidden fixed inset-0 flex justify-center items-center z-50">
    <div class="absolute inset-0 bg-black bg-opacity-50" onclick="closeModal()"></div>
    <div class="relative bg-white rounded-lg shadow-lg p-6 w-96 z-10">
      <h3 class="text-lg font-bold mb-4">Add Delivery Boy</h3>
      <form id="deliveryBoyForm" class="space-y-3">
        <input type="text" placeholder="Full Name" class="w-full border rounded px-3 py-2" required />
        <input type="text" placeholder="Phone Number" class="w-full border rounded px-3 py-2" required />
        <input type="text" placeholder="Vehicle Number" class="w-full border rounded px-3 py-2" required />
        <div class="flex justify-end gap-2 mt-4">
          <button type="button" onclick="closeModal()" class="px-4 py-2 bg-gray-300 rounded">Cancel</button>
          <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Save</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    lucide.createIcons();

    function openModal() {
      document.getElementById("deliveryBoyModal").classList.remove("hidden");
    }

    function closeModal() {
      document.getElementById("deliveryBoyModal").classList.add("hidden");
    }

    // Success banner function
    function showSuccessBanner() {
      let banner = document.getElementById("successBanner");
      banner.classList.remove("hidden");
      setTimeout(()=> banner.classList.add("hidden"), 3000);
    }

    // Handle form submit
    document.getElementById("deliveryBoyForm").addEventListener("submit", function(e){
      e.preventDefault();
      closeModal();
      showSuccessBanner();
    });

    // Assign / Reassign Button Toggle
    document.querySelectorAll(".assign-btn").forEach(btn => {
      btn.addEventListener("click", function(){
        this.textContent = "Assigned";
        this.classList.remove("bg-blue-500");
        this.classList.add("bg-green-600");
      });
    });

    // Status Badge Colors
    document.querySelectorAll(".status-badge").forEach(badge => {
      const status = badge.getAttribute("data-status");
      let baseClass = "px-2 py-1 rounded text-sm";
      if(status === "In Progress") badge.className = baseClass + " bg-yellow-100 text-yellow-700 status-badge";
      if(status === "Dispatched") badge.className = baseClass + " bg-blue-100 text-blue-700 status-badge";
      if(status === "Yet To Start") badge.className = baseClass + " bg-gray-300 text-gray-800 status-badge";
      if(status === "Assigned") badge.className = baseClass + " bg-green-100 text-green-700 status-badge";
    });
  </script>
  
<!-- Assign Modal -->
  <div id="assignModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
  <div class="bg-white p-6 rounded shadow-lg w-96">
    <h2 class="text-lg font-bold mb-4">Assign Delivery</h2>

    <label class="block mb-2">Start Date</label>
    <input type="date" id="startDate" class="border rounded w-full px-2 py-1 mb-3">

    <label class="block mb-2">End Date (Delivery Date)</label>
    <input type="date" id="endDate" class="border rounded w-full px-2 py-1 mb-3">

    <label class="block mb-2">Priority</label>
    <select id="priority" class="border rounded w-full px-2 py-1 mb-3">
      <option value="High">High</option>
      <option value="Medium">Medium</option>
      <option value="Low">Low</option>
    </select>

    <div class="flex justify-end gap-2">
      <button onclick="closeAssignModal()" class="px-3 py-1 border rounded">Cancel</button>
      <button id="saveAssign" class="px-3 py-1 bg-blue-500 text-white rounded">Save</button>
    </div>
  </div>
</div>

<script>
  const modal = document.getElementById("assignModal");
  const saveBtn = document.getElementById("saveAssign");
  const assignSelectedBtn = document.getElementById("assignSelectedBtn");
  const noPendingMsg = document.getElementById("noPendingMsg");
  let selectedRows = [];

  // Open modal (single row)
  document.querySelectorAll(".assign-btn").forEach(btn => {
    btn.addEventListener("click", function () {
      selectedRows = [this.closest("tr")];
      modal.classList.remove("hidden");
      modal.classList.add("flex");
    });
  });

  // Bulk assign button
  assignSelectedBtn.addEventListener("click", function () {
    selectedRows = Array.from(document.querySelectorAll(".row-select:checked")).map(cb => cb.closest("tr"));
    modal.classList.remove("hidden");
    modal.classList.add("flex");
  });

  // Save changes
  saveBtn.addEventListener("click", function () {
    const endDate = document.getElementById("endDate").value;
    const priority = document.getElementById("priority").value;

    selectedRows.forEach(row => {
      // update delivery date
      row.querySelector(".delivery-date").textContent = endDate;

      // update priority badge
      let badge = "";
      if (priority === "High") badge = `<span class="bg-red-100 text-red-700 px-2 py-1 rounded text-sm">High</span>`;
      if (priority === "Medium") badge = `<span class="bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-sm">Medium</span>`;
      if (priority === "Low") badge = `<span class="bg-green-100 text-green-700 px-2 py-1 rounded text-sm">Low</span>`;
      row.querySelector(".priority-cell").innerHTML = badge;
      

      // update button
      const btn = row.querySelector(".assign-btn");
      btn.textContent = "Assigned";
      btn.classList.remove("bg-blue-500");
      btn.classList.add("bg-green-500");
      btn.disabled = true;
    });
modal.classList.add("hidden");
    updatePendingMessage();

    closeAssignModal();
  });

  function closeAssignModal() {
    modal.classList.add("hidden");
    modal.classList.remove("flex");
  }

  // Handle checkboxes & Assign Selected visibility
  const checkboxes = document.querySelectorAll(".row-select");
  const selectAll = document.getElementById("selectAll");

  function toggleAssignSelected() {
    const checked = document.querySelectorAll(".row-select:checked").length;
    assignSelectedBtn.classList.toggle("hidden", checked < 2);
  }

  checkboxes.forEach(cb => cb.addEventListener("change", toggleAssignSelected));
  selectAll.addEventListener("change", function () {
    checkboxes.forEach(cb => (cb.checked = this.checked));
    toggleAssignSelected();
  });


  // Pending message
    function updatePendingMessage() {
      const rows = document.querySelectorAll("tbody tr");
      let pending = 0;
      rows.forEach(row => {
        const btn = row.querySelector(".assign-btn");
        const assigned = btn && btn.textContent.trim() === "Assigned";
        if (!assigned) pending++;
      });
      const msg = document.getElementById("pendingMsg");
      if (pending === 0) msg.textContent = "No pending orders for delivery.";
      else msg.textContent = pending === 1 ? "1 orders pending assignment for delivery." : `${pending} orders pending assignment for delivery..`;
    }

    // Init
    updatePendingMessage();
  </script>
</script>
<!-- <section class="p-6 overflow-y-auto flex-1">
      <div class="flex justify-between items-center mb-4"> -->
        <!-- <h2 class="text-xl font-bold">Clients</h2>
        <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" type="button" onclick="openUploadModal()">Import CSV</button> -->
      <!-- </div> -->

      <!-- <div class="bg-white p-4 rounded-xl shadow">
        <form class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <input class="border p-2 rounded" placeholder="Organization Name" />
          <input class="border p-2 rounded" placeholder="Contact Person" />
          <input type="email" class="border p-2 rounded" placeholder="Email" />
          <input type="tel" class="border p-2 rounded" placeholder="Phone" />
          <button type="button" 
        class="bg-blue-600 text-white px-4 py-2 rounded md:col-span-2" 
        onclick="openClientModal()">
  Add Client
</button> -->
          <!-- Create Client Modal -->
<!-- <div id="clientModal" class="modal-overlay">
  <div class="modal-container max-w-xl w-full">
    <div class="modal-header">
      <div class="modal-title">üìù Create Client</div>
      <button class="close-btn" onclick="closeClientModal()">√ó</button>
    </div> -->
    <!-- <div class="modal-body">
      <form id="clientForm" class="space-y-4">
        <input type="text" placeholder="Organization Name" class="w-full border p-2 rounded" required>
        <input type="text" placeholder="Contact Person" class="w-full border p-2 rounded" required>
        <input type="email" placeholder="Email Address" class="w-full border p-2 rounded" required>
        <input type="tel" placeholder="Phone Number" class="w-full border p-2 rounded" required>
        <input type="text" placeholder="Address" class="w-full border p-2 rounded">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <input type="text" placeholder="City" class="border p-2 rounded">
          <input type="text" placeholder="State / Province" class="border p-2 rounded">
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <input type="text" placeholder="Country" class="border p-2 rounded">
          <input type="text" placeholder="GST / Tax ID" class="border p-2 rounded">
        </div>
        <textarea placeholder="Notes" class="w-full border p-2 rounded"></textarea>
      </form>
    </div>
    <div class="modal-footer"> -->
      <!-- <form id="clientForm" class="space-y-4"> -->
  <!-- form fields here -->
  <!-- <div class="flex justify-end gap-3 pt-4">
    <button class="btn btn-secondary" type="button" onclick="closeClientModal()">Cancel</button>
    <button class="btn btn-primary" type="submit">Save Client</button>
  </div> -->
</form>
    </div>
  </div>
</div>

<script>
  function openClientModal() {
    document.getElementById('clientModal').classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  function closeClientModal() {
    document.getElementById('clientModal').classList.remove('active');
    document.body.style.overflow = 'auto';
  }

  document.getElementById('clientForm').addEventListener('submit', function(e) {
    e.preventDefault();
    alert('‚úÖ Client created successfully!');
    closeClientModal();
  });
</script>
        </form>
      </div>
    </section>
  </main>

  <<!-- Upload Modal -->
    <div id="uploadModal" class="modal-overlay">
        <div class="modal-container">
            <!-- Header -->
            <div class="modal-header">
                <div class="modal-title">
                    üìÅ Import Files
                </div>
                <button class="close-btn" onclick="closeUploadModal()">
                    √ó
                </button>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <!-- Upload Area -->
                <div class="upload-area" id="uploadArea">
                    <input type="file" 
                           id="fileInput" 
                           class="file-input" 
                           accept=".csv,.xlsx,.xls" 
                           multiple
                           onchange="handleFileSelect(event)">
                    
                    <div class="upload-icon" id="uploadIcon">üìÅ</div>
                    
                    <div class="upload-text" id="uploadText">
                        Drag & drop your files here
                    </div>
                    
                    <div class="upload-subtext">
                        or <strong>click to browse</strong> from your device
                    </div>
                    
                    <div style="margin-top: 16px;">
                        <div class="btn btn-primary" style="pointer-events: none;">
                            üìÇ Choose Files
                        </div>
                    </div>
                </div>

                <!-- Supported Formats -->
                <div class="supported-formats">
                    <h4>üìã Supported File Formats</h4>
                    <div class="format-list">
                        <span class="format-tag">CSV</span>
                        <span class="format-tag">XLSX</span>
                        <span class="format-tag">XLS</span>
                    </div>
                    <div style="margin-top: 12px; font-size: 12px; color: #6b7280;">
                        Maximum file size: 10MB per file
                    </div>
                </div>

                <!-- Upload Progress -->
                <div class="upload-progress" id="uploadProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progressText">Uploading...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                </div>

                <!-- File Preview -->
                <div class="file-preview" id="filePreview">
                    <h4 style="margin-bottom: 16px; color: #374151;">üìÑ Selected Files</h4>
                    <div id="fileList">
                        <!-- Files will be displayed here -->
                    </div>
                </div>

                <!-- Error Message -->
                <div class="error-message" id="errorMessage">
                    <!-- Error messages will appear here -->
                </div>

                <!-- Success Message -->
                <div class="success-message" id="successMessage">
                    <!-- Success messages will appear here -->
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer">
                <div class="footer-info">
                    <span id="fileCount">0 files selected</span> ‚Ä¢ 
                    <span id="totalSize">0 KB</span>
                </div>
                <div class="footer-actions">
                    <button class="btn btn-secondary" onclick="clearFiles()">
                        üóëÔ∏è Clear All
                    </button>
                    <button class="btn btn-primary" id="uploadBtn" onclick="uploadFiles()" disabled>
                        <span id="uploadBtnText">‚¨ÜÔ∏è Upload Files</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

  <script>
        let selectedFiles = [];
        let isDragging = false;

        // Modal Functions
        function openUploadModal() {
            document.getElementById('uploadModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            resetModal();
        }

        function resetModal() {
            selectedFiles = [];
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').classList.remove('active');
            document.getElementById('uploadProgress').classList.remove('active');
            document.getElementById('errorMessage').classList.remove('active');
            document.getElementById('successMessage').classList.remove('active');
            document.getElementById('fileList').innerHTML = '';
            updateFileCounter();
            updateUploadButton();
        }

        // Drag and Drop Functionality
        const uploadArea = document.getElementById('uploadArea');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
            document.getElementById('uploadIcon').textContent = 'üì•';
            document.getElementById('uploadText').textContent = 'Drop files here to upload';
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            if (!uploadArea.contains(e.relatedTarget)) {
                uploadArea.classList.remove('dragover');
                document.getElementById('uploadIcon').textContent = 'üìÅ';
                document.getElementById('uploadText').textContent = 'Drag & drop your files here';
            }
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            document.getElementById('uploadIcon').textContent = 'üìÅ';
            document.getElementById('uploadText').textContent = 'Drag & drop your files here';
            
            const files = Array.from(e.dataTransfer.files);
            processFiles(files);
        });

        // File Selection
        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            processFiles(files);
        }

        function processFiles(files) {
            hideMessages();
            
            const validFiles = [];
            const errors = [];

            files.forEach(file => {
                // Check file type
                const allowedTypes = ['.csv', '.xlsx', '.xls'];
                const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                
                if (!allowedTypes.includes(fileExtension)) {
                    errors.push(`${file.name}: Unsupported file type. Please use CSV, XLSX, or XLS files.`);
                    return;
                }

                // Check file size (10MB limit)
                const maxSize = 10 * 1024 * 1024; // 10MB
                if (file.size > maxSize) {
                    errors.push(`${file.name}: File too large. Maximum size is 10MB.`);
                    return;
                }

                // Check if file already selected
                if (selectedFiles.some(f => f.name === file.name && f.size === file.size)) {
                    errors.push(`${file.name}: File already selected.`);
                    return;
                }

                validFiles.push(file);
            });

            // Show errors if any
            if (errors.length > 0) {
                showError(errors.join('<br>'));
            }

            // Add valid files
            if (validFiles.length > 0) {
                selectedFiles.push(...validFiles);
                displayFiles();
                updateFileCounter();
                updateUploadButton();
                
                if (errors.length === 0) {
                    showSuccess(`${validFiles.length} file(s) added successfully!`);
                }
            }
        }

        function displayFiles() {
            const fileList = document.getElementById('fileList');
            const filePreview = document.getElementById('filePreview');
            
            fileList.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const fileItem = createFileItem(file, index);
                fileList.appendChild(fileItem);
            });

            if (selectedFiles.length > 0) {
                filePreview.classList.add('active');
            }
        }

        function createFileItem(file, index) {
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';

            const fileExtension = file.name.split('.').pop().toLowerCase();
            let iconClass, iconText;

            switch (fileExtension) {
                case 'csv':
                    iconClass = 'csv-icon';
                    iconText = 'üìä';
                    break;
                case 'xlsx':
                case 'xls':
                    iconClass = 'excel-icon';
                    iconText = 'üìó';
                    break;
                default:
                    iconClass = 'error-icon';
                    iconText = '‚ùå';
            }

            fileItem.innerHTML = `
                <div class="file-icon ${iconClass}">
                    ${iconText}
                </div>
                <div class="file-details">
                    <div class="file-name">${file.name}</div>
                    <div class="file-meta">
                        <div class="file-size">
                            üìè ${formatFileSize(file.size)}
                        </div>
                        <div class="file-type">
                            üè∑Ô∏è ${fileExtension.toUpperCase()}
                        </div>
                        <div style="color: #6b7280;">
                            üìÖ ${new Date().toLocaleDateString()}
                        </div>
                    </div>
                </div>
                <div class="file-actions">
                    <button class="action-btn preview-btn" onclick="previewFile(${index})">
                        üëÅÔ∏è Preview
                    </button>
                    <button class="action-btn remove-btn" onclick="removeFile(${index})">
                        üóëÔ∏è Remove
                    </button>
                </div>
            `;

            return fileItem;
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFiles();
            updateFileCounter();
            updateUploadButton();
            
            if (selectedFiles.length === 0) {
                document.getElementById('filePreview').classList.remove('active');
            }
            
            showSuccess('File removed successfully!');
        }

        function previewFile(index) {
            const file = selectedFiles[index];
            
            // For demo purposes, show file info
            alert(`File Preview:\n\nName: ${file.name}\nSize: ${formatFileSize(file.size)}\nType: ${file.type}\nLast Modified: ${new Date(file.lastModified).toLocaleString()}\n\nNote: In a real application, this would show file contents preview.`);
        }

        function clearFiles() {
            if (selectedFiles.length === 0) return;
            
            if (confirm(`Are you sure you want to remove all ${selectedFiles.length} selected files?`)) {
                selectedFiles = [];
                document.getElementById('filePreview').classList.remove('active');
                updateFileCounter();
                updateUploadButton();
                showSuccess('All files cleared successfully!');
            }
        }

        function updateFileCounter() {
            const fileCount = selectedFiles.length;
            const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
            
            document.getElementById('fileCount').textContent = `${fileCount} file${fileCount !== 1 ? 's' : ''} selected`;
            document.getElementById('totalSize').textContent = formatFileSize(totalSize);
        }

        function updateUploadButton() {
            const uploadBtn = document.getElementById('uploadBtn');
            uploadBtn.disabled = selectedFiles.length === 0;
        }

        // Upload Functionality
        function uploadFiles() {
            if (selectedFiles.length === 0) {
                showError('Please select at least one file to upload.');
                return;
            }

            hideMessages();
            showUploadProgress();
            
            // Simulate upload process
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    
                    setTimeout(() => {
                        hideUploadProgress();
                        showSuccess(`Successfully uploaded ${selectedFiles.length} file(s)! üéâ`);
                        
                        // In a real application, you would process the files here
                        console.log('Uploaded files:', selectedFiles);
                        
                        // Reset after success
                        setTimeout(() => {
                            closeUploadModal();
                        }, 2000);
                    }, 500);
                }
                
                updateProgress(progress);
            }, 200);
        }

        function showUploadProgress() {
            document.getElementById('uploadProgress').classList.add('active');
            document.getElementById('uploadBtn').disabled = true;
            document.getElementById('uploadBtnText').innerHTML = '<span class="loading"></span> Uploading...';
        }

        function hideUploadProgress() {
            document.getElementById('uploadProgress').classList.remove('active');
            document.getElementById('uploadBtn').disabled = false;
            document.getElementById('uploadBtnText').innerHTML = '‚¨ÜÔ∏è Upload Files';
        }

        function updateProgress(percent) {
            const progressFill = document.getElementById('progressFill');
            const progressPercent = document.getElementById('progressPercent');
            const progressText = document.getElementById('progressText');
            
            progressFill.style.width = percent + '%';
            progressPercent.textContent = Math.round(percent) + '%';
            
            if (percent < 50) {
                progressText.textContent = 'Uploading files...';
            } else if (percent < 80) {
                progressText.textContent = 'Processing files...';
            } else if (percent < 95) {
                progressText.textContent = 'Almost done...';
            } else {
                progressText.textContent = 'Finalizing upload...';
            }
        }

        // Message Functions
        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.innerHTML = '‚ùå ' + message;
            errorElement.classList.add('active');
            
            setTimeout(() => {
                hideMessages();
            }, 5000);
        }

        function showSuccess(message) {
            const successElement = document.getElementById('successMessage');
            successElement.innerHTML = '‚úÖ ' + message;
            successElement.classList.add('active');
            
            setTimeout(() => {
                hideMessages();
            }, 3000);
        }

        function hideMessages() {
            document.getElementById('errorMessage').classList.remove('active');
            document.getElementById('successMessage').classList.remove('active');
        }

        // Close modal on outside click
        document.getElementById('uploadModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('uploadModal')) {
                closeUploadModal();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.getElementById('uploadModal').classList.contains('active')) {
                closeUploadModal();
            }
        });

        // Prevent default drag behaviors on the entire page
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            document.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
    </script>
<!-- Lucide Icons -->
  <script>lucide.createIcons();</script>
</body>
</html>
